document.addEventListener("DOMContentLoaded",(function(){const t=document.getElementById("cityModal"),e=document.querySelectorAll(".modal-cityChoose"),o=document.querySelector(".closeCityModal"),c=document.querySelectorAll(".cityItem");e.forEach((e=>{e.style.cursor="pointer",e.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),t.style.display="block",setTimeout((()=>{t.style.opacity="1"}),10)}))})),o&&o.addEventListener("click",(function(){t.style.opacity="0",setTimeout((()=>{t.style.display="none"}),300)})),window.addEventListener("click",(function(e){e.target===t&&(t.style.opacity="0",setTimeout((()=>{t.style.display="none"}),300))})),c.forEach((e=>{e.addEventListener("click",(function(){const e=this.getAttribute("data-city");localStorage.setItem("selectedCity",e),localStorage.removeItem("selectedMetro"),fetch('/api/city/set',{method:'POST',headers:{'Content-Type':'application/json','X-CSRF-TOKEN':document.querySelector('meta[name="csrf-token"]')?.getAttribute('content')||''},body:JSON.stringify({city:e})}).then(()=>{t.style.opacity="0",setTimeout((()=>{t.style.display="none"}),300),window.location.reload()}).catch(()=>{t.style.opacity="0",setTimeout((()=>{t.style.display="none"}),300),window.location.reload()})}))})),function(){const o="spb"===(localStorage.getItem("selectedCity")||getCookie("selectedCity")||"moscow")?"Санкт-Петербург":"Москва";e.forEach((t=>{t.textContent=o}));function getCookie(t){const e=`; ${document.cookie}`;const o=e.split(`; ${t}=`);return o.length===2?o.pop().split(';').shift():null}}()}));